<project name="NetarchiveSuite-Deployment">

    <!-- Create the subversion version string -->
    <exec executable="svnversion" failifexecutionfails="no" outputproperty="svn.Revision">
      <arg value="."/> 
      <arg value="-n"/>
    </exec>

    <target name="package" description="Create the package to deploy to the test system">    	
		<ant antfile="${basedir}/../build.xml" dir="${basedir}/.." target="releasezipball" />
        <echo>Packaging revision: ${svn.Revision}</echo>
		<move file="${basedir}/../NetarchiveSuite.zip" tofile="target/deploy/NetarchiveSuite-${svn.Revision}.zip" /> 
    </target>
    
    <target name="deploy2test" description="Copies the zip file to the test server">
        <!-- Requires that a private/public key login has been enabled for this account -->      
	<scp file="target/deploy/NetarchiveSuite-${svn.Revision}.zip" 
	  toDir="test@kb-prod-udv-001.kb.dk:~/release_software_dist/releases"
       	  keyfile="${user.home}/.ssh/id_rsa" /> 
    </target>
</project>

